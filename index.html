<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>FantaPapa 2025</title>
  <link rel="stylesheet" href="style.css">
  <style>
    /* Stili per i controlli di ordinamento */
    .sorting-controls {
      margin-bottom: 20px;
      display: flex;
      gap: 10px;
      align-items: center;
    }
    .sort-btn {
      padding: 8px 16px;
      background-color: #f0f0f0;
      border: 1px solid #ccc;
      border-radius: 4px;
      cursor: pointer;
      transition: background-color 0.3s;
    }
    .sort-btn:hover, .sort-btn.active {
      background-color: #ddd;
    }
    .sort-btn.active {
      font-weight: bold;
    }
  </style>
</head>
<body>
<header>
  <div class="container">
    <h1>FantaPapa 2025</h1>
    <p>Crea la tua squadra di Cardinali per il prossimo Conclave!</p>
    <div class="countdown" id="countdown">Conclave tra 8 giorni</div>
  </div>
</header>

<div class="container">
  <div class="nav-tabs">
    <button class="tab-btn active" data-tab="cardinali">Cardinali Papabili</button>
    <button class="tab-btn" data-tab="regolamento">Regolamento</button>
    <button class="tab-btn" data-tab="squadre">Squadre</button>
  </div>

  <div id="cardinali" class="content-pane active">
    <h2>I Cardinali Papabili</h2>
    <p>Esplora i profili dei cardinali che potrebbero diventare il prossimo Papa. Clicca su una scheda per saperne di più.</p>

    <!-- Controlli di ordinamento -->
    <div class="sorting-controls">
      <span>Ordina per:</span>
      <button class="sort-btn active" data-sort="default">Default</button>
      <button class="sort-btn" data-sort="nome">Nome (A-Z)</button>
      <button class="sort-btn" data-sort="paese">Paese</button>
      <button class="sort-btn" data-sort="continente">Continente</button>
    </div>

    <div class="card-container" id="cardinali-container">
      <!-- Le schede dei cardinali saranno generate da JavaScript -->
    </div>

    <!-- <a href="https://forms.gle/yourGoogleFormLink" target="_blank" class="google-form-button">
      PARTECIPA AL FANTAPAPA - COMPILA IL MODULO
    </a>-->
  </div>

  <div id="regolamento" class="content-pane">
    <div class="rules">
      <h2>Regolamento del FantaPapa</h2>
      <h3>Come si gioca</h3>
      <p>Il FantaPapa è un gioco di previsione per l'elezione del nuovo Pontefice. Ogni partecipante seleziona una squadra di 5 cardinali che ritiene possano diventare il prossimo Papa.</p>

      <h3>Punteggi</h3>
      <ul>
        <li><strong>100 punti</strong> - Se hai nella tua squadra il cardinale eletto Papa</li>
        <li><strong>50 punti extra</strong> - Se hai previsto correttamente il nome papale</li>
        <li><strong>25 punti</strong> - Per ogni cardinale nella tua squadra che ha ricevuto voti durante il conclave (se l'informazione sarà disponibile)</li>
        <li><strong>10 punti</strong> - Se hai previsto correttamente il numero di scrutini necessari (±1)</li>
      </ul>

      <h3>Regole di partecipazione</h3>
      <ol>
        <li>Ogni partecipante può registrare una sola squadra</li>
        <li>Le squadre devono essere registrate prima dell'inizio del conclave</li>
        <li>Una volta registrata, la squadra non può essere modificata</li>
        <li>La classifica finale sarà pubblicata dopo l'elezione del nuovo Papa</li>
      </ol>
    </div>
  </div>

  <div id="squadre" class="content-pane">
    <div class="teams">
      <h2>Squadre Registrate</h2>
      <p>Le squadre registrate saranno visibili qui non appena confermate.</p>

      <div id="teams-container">
        <!-- Le squadre saranno generate da JavaScript o popolate manualmente -->

        <div class="team-item">
          <div class="team-name">Marco Rossi</div>
          <div class="team-selection">
            <span class="team-cardinal">Luis Antonio Tagle</span>
            <span class="team-cardinal">Matteo Zuppi</span>
            <span class="team-cardinal">Óscar Rodríguez Maradiaga</span>
            <span class="team-cardinal">Robert Sarah</span>
            <span class="team-cardinal">Péter Erdő</span>
          </div>
          <div>Nome papale previsto: <strong>Leone XIV</strong></div>
        </div>

        <div class="team-item">
          <div class="team-name">Giulia Bianchi</div>
          <div class="team-selection">
            <span class="team-cardinal">Pietro Parolin</span>
            <span class="team-cardinal">Christoph Schönborn</span>
            <span class="team-cardinal">Sean Patrick O'Malley</span>
            <span class="team-cardinal">Matteo Zuppi</span>
            <span class="team-cardinal">Marc Ouellet</span>
          </div>
          <div>Nome papale previsto: <strong>Giovanni XXIV</strong></div>
        </div>
      </div>
    </div>
  </div>
</div>

<div style="position: relative; width: 100%; overflow: hidden; padding-top: 75%;">
  <iframe
          style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border: none;"
          src="https://docs.google.com/forms/d/e/1FAIpQLSee7tGjbVMF4UoncrOntlB_FmA56tyueCJlhqCptyXdR-B3iw/viewform?embedded=true">
    Caricamento...
  </iframe>
</div>
<footer>
  <div class="container">
    <p>FantaPapa 2025 - Un gioco di previsione per l'elezione del nuovo Papa</p>
  </div>
</footer>

<!-- Carica il file con i dati dei cardinali -->
<script src="CardList.js"></script>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    const cardinaliContainer = document.getElementById('cardinali-container');
    const sortButtons = document.querySelectorAll('.sort-btn');

    // Variabile per conservare la copia dei dati originali
    let cardinaliCopy = [...cardinali];

    // Funzione per creare una card di cardinale
    function createCardinalCard(cardinale) {
      const cardElement = document.createElement('div');
      cardElement.className = 'cardinal-card';
      cardElement.innerHTML = `
        <img src="${cardinale.imageUrl}" alt="${cardinale.nome}">
        <div class="info">
          <h3>${cardinale.nome}</h3>
          <p>${cardinale.eta || calculateAge(cardinale.dataNascita)} anni</p>
          <p>${cardinale.paese}</p>
          <p>${cardinale.ruolo}</p>
          <div class="stats">
            <span>${cardinale.continente}</span>
          </div>
        </div>
      `;

      // Aggiunta dell'evento per reindirizzare a Wikipedia quando si clicca sulla scheda
      cardElement.addEventListener('click', function() {
        window.open(cardinale.wikiUrl, '_blank');
      });

      return cardElement;
    }

    // Funzione per calcolare l'età dai dati di nascita
    function calculateAge(dataNascita) {
      if (!dataNascita) return "N/A";

      const [day, month, year] = dataNascita.split('/').map(Number);
      const birthDate = new Date(year, month - 1, day);
      const today = new Date();

      let age = today.getFullYear() - birthDate.getFullYear();
      const m = today.getMonth() - birthDate.getMonth();

      if (m < 0 || (m === 0 && today.getDate() < birthDate.getDate())) {
        age--;
      }

      return age;
    }

    // Funzione per ordinare e visualizzare i cardinali
    function sortAndDisplayCardinali(sortKey) {
      // Svuota il container
      cardinaliContainer.innerHTML = '';

      // Clona l'array originale per non modificarlo
      const sortedCardinali = [...cardinaliCopy];

      // Applica l'ordinamento in base alla chiave selezionata
      switch(sortKey) {
        case 'nome':
          sortedCardinali.sort((a, b) => a.nome.localeCompare(b.nome));
          break;
        case 'paese':
          sortedCardinali.sort((a, b) => a.paese.localeCompare(b.paese));
          break;
        case 'continente':
          sortedCardinali.sort((a, b) => a.continente.localeCompare(b.continente));
          break;
        default:
          // Lascia l'ordine originale
          break;
      }

      // Crea e aggiungi le card per ogni cardinale
      sortedCardinali.forEach(cardinale => {
        cardinaliContainer.appendChild(createCardinalCard(cardinale));
      });
    }

    // Gestisce i clic sui pulsanti di ordinamento
    sortButtons.forEach(button => {
      button.addEventListener('click', function() {
        // Rimuove la classe active da tutti i pulsanti
        sortButtons.forEach(btn => btn.classList.remove('active'));
        // Aggiunge la classe active al pulsante cliccato
        this.classList.add('active');

        // Ordina e visualizza i cardinali in base alla chiave selezionata
        sortAndDisplayCardinali(this.getAttribute('data-sort'));
      });
    });

    // Salva una copia dei dati originali e mostra le card all'avvio
    cardinaliCopy = [...cardinali];
    sortAndDisplayCardinali('default');

    // Gestione della navigazione a schede
    const tabButtons = document.querySelectorAll('.tab-btn');
    const contentPanes = document.querySelectorAll('.content-pane');

    tabButtons.forEach(button => {
      button.addEventListener('click', () => {
        const tab = button.getAttribute('data-tab');

        tabButtons.forEach(btn => btn.classList.remove('active'));
        contentPanes.forEach(pane => pane.classList.remove('active'));

        button.classList.add('active');
        document.getElementById(tab).classList.add('active');
      });
    });
  });
</script>
</body>
</html>